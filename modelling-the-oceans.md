## What are models?
conceptual, numerical and physical
Scientific analysis of any real world problem requires some abstraction and conceptualization to a representation that can be readily analysed. These representations or models can take a wide range of forms that are amenable to analysis. 

Models may be physical, statistical or mathematical. Physical models (or experimental models) usually involve a downscaled physical representation of (what are conceptualised as) the essential characteristics of the subject of the study. Examples would include a faithful scale- model of a particular harbour or coast region and flumes and wave tunnels with a simple or idealized geometry. Physical models are often used for studies of coastal processes and coastal engineering projects. They are rarely used for studies of regional coastal waters.

Mathematical models require and follow from the representation of the subject by equations. Mathematical models can be analytical or numerical. A simple abstraction of a real world problem may be sufficiently simple to allow an analytical (and sometimes exact) solution of the equations and may be very useful. However, if the representation is too simplistic for the objective, then a more complicated representation may be necessary, such that an analytical solution is impossible. In this case, numerical methods are necessary, usually solving the partial differential equations. Most numerical models require some form of “time stepping” in which an estimation of the progress of the state of the subject to a later time is calculated from the original state and the governing equations, although steady-state models e.g. assuming a periodic solution, may also be used. Many coastal ocean models (“3D models”) also discretize a volume of water into increments of depth, latitude and longitude and within a timestep, movement of properties between adjacent spatial increments are also calculated. Resolving a domain (the period and volume of interest) into a very large number of discrete elements is the origin of the high demand of most numerical models on computing resources (both the number of computations and the data storage). Simpler models can be useful and reduce the computing demand. Depth-averaged (“2D”) models are common and are sufficient for some applications. Simpler but useful representations for some purposes include “box models” that consider a small number of discrete elements and circuit analogues. Numerical models are widely used to describe coastal regions and can also be used to study particular processes. Numerical models are the default tool for most coastal ocean modelling and will be the main subject of this document.

Statistical models rely on data and are especially useful where mechanistic understanding is insufficient for a plausible numerical model to be constructed. Statistical modelling can also be used in the analysis of the output from numerical models, especially where the outputs are too large or complicated for direct interpretation. Statistical modelling will certainly remain a large part of the analysis of most numerical coastal ocean models, but otherwise are beyond the scope of this document.

## What is a coastal hydrodynamic model?

### Overview
Hydrodynamic models are used to simulate water motion in coastal regions, and can model a range of processes from the sub-metre (engineering) scale, up to hundreds of kilometres (regional scale). They can be applied to both marine biological (environmental) and engineering concerns, or indeed simultaneously both: applications can be in pollution transport, algal blooms, sea lice propagation from (and to) fish farms, tidal resource estimation and environmental impact assessments for tidal farms.

Historically, hydrodynamic models were physical models built to scale, but with advances in computational power, using hydrodynamic numerical models became more common and widely used. Hydrodynamic numerical models are mathematical models that usually solve, in some form, the Navier-Stokes momentum equations (themselves derived from Newton’s equations of motion, under certain assumptions), and can predict the future state of fluid systems for a given initial state. At the very least, the state consists of the surface elevation, velocity, pressure, but frequently also includes salinity, density, temperature, turbulence parameters and tracer terms. Typically, they start from ‘at rest’, meaning the water within the model domain is initially static, and then tidal (or other) forcing at the boundaries is used to drive the flow through the domain. Optionally, these boundary conditions can also include velocity terms and turbulence parameters. Surface atmospheric forcing can also be used to drive the model.
The many features and facets of hydrodynamic models

### Discretisation schemes
There are three fundamental types of discretisation schemes historically popular in hydrodynamic models, each of which have various strengths and weaknesses. These are: i) finite difference, ii) finite element and iii) finite volume methods. Interleaved with the use of these are structured and unstructured grids. As their names imply, structured grids have a regular structure, meaning that the grid cells, the fundamental spatial unit of the model, cannot have an arbitrary geometry or arrangement: rather both are very tightly specified. This can be a problem in coastal modelling, which gets around such issues by labelling cells either wet (ie. containing water) or dry (on land). Whilst this may seem like a major disadvantage, the considerable advantage of structure grids is that in the right circumstances, their use can be orders of magnitude more computationally and memory efficient [REF needed]. 

Identify difference between hydrodynamic and CFD (computational fluid dynamics) models - probably now these overlap considerably).

Finite volume methods (FVM) [1][2] were developed to tackle highly turbulent flow with Reynolds numbers orders of magnitude higher than were possible with finite difference methods of the time. FVM does this by using an integral rather than differential form of the Navier Stokes momentum equations, which ensures that the momentum is conserved on a local per-cell basis, rather than a global (domain) scale as with finite difference schemes. Synonymous with this was the development of the SIMPLE scheme by Patankar and Spalding [1978 ref] which dealt with the problem of coupling pressure and momentum terms that both must be solved simultaneously. Finite volume schemes are prevalent in engineering due to their stability when modelling turbulent flows, but also are used in the very popular FVCOM regional coastal model. The main disadvantage of FVM is that it is low order; this means that high order (ie. polynomial) representations of velocity are not possible beyond quadratic interpolation without great computational expense. This means that unless a specialised wall model is used, boundary layer flows cannot be adequately resolved and thus estimations of bed stress will be inaccurate. FVM can however be naturally adapted to unstructured grids, which makes them suitable for dealing with irregular domains. With unstructured grids, the geometry and order of cells within a grid can be entirely arbitrary, thus will readily fit to coastal domains.

Finite element methods (FEM) [REFS] originally evolved for structural analysis in civil and mechanical engineering, but have since been adapted to computational fluid dynamics problems. Finite elements use what are called basis functions to describe fluid prognostics such as pressure and velocity. These basis functions can be of arbitrary order, and so very high order elements can be used to say, resolve velocity shear in a boundary layer. However, in their original formulation, where these basis functions were continuous across elements, high Reynolds number flows such a coastal problems were not practical due to the instability of the continuous discretisation. In recent developments, discontinuous basis functions have been developed, which, by breaking the continuity of velocity field can impose local momentum continuity. This has made discontinuous FEM suitable for highly turbulent flow; moreover these can be on unstructured grids as FEM naturally adapts to such grids. However, they are currently quite computational expensive to run, as the discontinuity increases the degrees of freedom of any given problem by almost an order of magnitude. 

References
1. S. Patankar. Numerical Heat Transfer and Fluid Flow. CRC Press, 1980.
2. H. Versteeg. An Introduction to Computational Fluid Dynamics: The Finite Volume Method. Prentice Hall, 2007.


* Finite-difference, finite-element, finite-volume
* Depth-integrated
* Sigma layer models - discuss the vertical coordinate system - this can be z-levels, sigma-levels (usually used in coastal and shelf seas), or hybrid coordinate.
* Hydrostatic, non-hydrostatic
* Turbulence models (RANS, eg. k-epsilon, k-omega SST, Large Eddy Simulation, Mellor-Yamada, GOTM)

### Model diagnostics 
The model output can be analysed over time and used for forecast guidance and other applications; such as operational modelling for water level and current forecast guidance, ecological and geospatial applications. This can be either in the form of local diagnostics (eg. virtual ADCP) through to writing out the entire simulation state (eg. velocity, pressure, etc.) for the entire domain. For example, analysing water level time series to calculate the average of the high and low water values can be used to determine the tidal datums. These results can be useful to a wide range of maritime community, providing that sufficient accuracy has been demonstrated from the model. The accuracy of the model can be determined by comparing the model output against real measurements of the water-levels and current velocities.

## Other models
In general, model systems are now being developed, in which the core is a 3D baroclinic, hydrodynamic model, but there are also ancillary models, which may be more or less closely coupled with the hydrodynamic model. There are many interaction processes in which contributions from other dynamic models may be affected (either 1-way or 2-way) by processes in other models. Examples include the atmospheric forcing terms for heat or momentum, in which parametrisations of fluxes may include effects of the surface of the ocean, such as SST or waves in the formulation.

### Wave modelling
There are various types of wave models, which may basically be divided into phase-resolving and phase-averaging models. In phase-resolving models (e.g. REF-DIF, FUNWAVE, refs) the individual waves on the sea surface are resolved, i.e. the surface is covered with a grid which is fine compared with the wave length (which may be from O(1) to O(100) metres). Phase-resolving models can be used only for regions of limited size because the computational grid has to be fine enough to resolve all relevant wavelengths. The actual limitation depends on the type of model used. There are time-dependent models and stationary models (in which the wave motion is purely periodic).
The most widely used time-dependent models are based on the Boussinesq equation, which is derived by integration over depth of the original 3-dimensional wave equation. The integration over depth limits the Boussinesq equation to be applicable in relatively shallow water, i.e. the depth must not be large compared with the wave length (although this requirement has been relaxed in recent work).
In phase-averaged models, only the statistics of the sea surface is computed, i.e. on points of a grid the action or energy spectra are computed. These types of models may be used from global to regional as well as local scales and are often called spectral wave models. Examples of the state-of-the-art, so-called 3rd-generation (3G), spectral wave models include WAM (such as ECWAM used at ECMWF) and WAVEWATCH III® (WW3, see https://polar.ncep.noaa.gov/waves/wavewatch/), now the standard model adopted by the UK Met Office) and Copernicus. 
The SWAN model (Booij et al., 1999) started a new era for the application of spectral wave modelling in the coastal zone. The SWAN model can be applied in stationary mode (no variation in time, assuming a steady state), in restricted coastal areas, but can also be run in non-stationary (time-stepping) mode.  SWAN is an open source code that can easily be implemented (http://www.swan.tudelft.nl/) and is the most widely-used spectral wave model code, by both the scientific and engineering community. SWAN is a 3G wave model using the same formulations for the source terms as WAM and WW3, plus some additional formulations primarily for shallow water. The numerical solution techniques are quite different - SWAN uses a semi-implicit method which allows longer time steps. SWAN can model many of the processes affecting wind-waves known today: wave generation by wind, wave propagation, current and depth refraction, frequency shifting due to currents and non-stationary water depth, wave dissipation by whitecapping, bottom friction, vegetation and depth-induced breaking, nonlinear interactions (both 4- and 3-wave interactions), wave induced setup, transmission and reflection by obstacles and diffraction. For many of the processes the user can choose between different formulations (e.g. the different combinations for wind input and white-capping/deep water dissipation terms). SWAN has been included in the FVCOM model suite, as SWAVE (Qi et al., 2009) but a new implementation of the coupling using the unstructured-grid SWAN model, unSWAN, has been carried out by Zheng et al. (2017), using the vortex force formalism, which has some improved features. The state of the art in coastal wave modelling is reviewed in Cavaleri et al. (2018).
Coupled FVCOM-SWAN (v.4.4.1) model start produce operational high-resolution waves parameters forecasts over the western coast of Scotland (WeStCOMS v2 domain) since December  2021 at SAMS, which is available via https://thredds.sams.ac.uk/ server.

## Sediment modelling
Sediment modelling is increasingly carried out as part of the requirement for ecosystem modelling in which fine sediment (suspended particulate matter, SPM) causes important changes in turbidity and hence light availability. Bottom sediment transport is important in the coastal zone in terms of coastal erosion and beach morphology, and how sediments affect the bottom roughness through grain size and bedforms. 

## Transport modelling including particle tracking
Often the main requirement for a model is to predict where some substance (whether conservative or non-conservative) is transported by the flow of water. This may include heat, salinity (or freshwater), nutrients, pollutants, biological organisms etc.  The transport may be modelled by an advection-dispersion module within the main hydrodynamic code or by a post-processing step, whereby the model currents are saved and used after the main hydrodynamic model run has been completed. Where the transported substance may be represented as particles (representing individual particles or groups of ‘real’ particles, with some characteristic), this may be referred to as a ‘particle-tracking’ model and may be run within the hydrodynamic code or offline, forced by previously saved hydrodynamic output. The latter has the advantage that movement of particles can be simulated independently of the (often more computationally expensive) hydrodynamics. Outputs from this type of model may be used to derive spread distributions of the focal substance, and in the case of “biological” particles, can be used to understand larval connectivity and its role in population dynamics. 

## Agent-based

## Biology and Biogeochemistry
Refer to ecosystem models e.g. ERSEM (European Regional Seas Ecosystem Model)

As part of EcoWatt2050 some work has been done on the interactions between physics from a baroclinic hydrodynamic model of NW shelf seas (NEMO-ERSEM  and FVCOM) and mobile marine species, including the joint distribution of predator-prey, at present and into the future. The parameters most effective in spatial correlation with distributions of species include bottom temperature, stratification and vertical velocity. Where ERSEM data on primary productivity are available, this is also a key parameter, but useful information can be derived from a physics model alone (Sadykova et al., 2017).

FVCOM-ERSEM code with FABM coupler was implemented in PML and recently applied at SAMS for the Scottish coastal waters test case study in Loch Ewe, nested into WeStCOMS domain under the NERC CAMPUS project at SAMS. This site was selected due to the availability of the longest plankton (phyto and zoo) observational dataset.

# Representation of infrastructure or forcing and illustrative examples
## Climate impact on fjord and sea loch circulation 	
Estuaries are dynamic but also fragile transition areas between the salty water from the ocean and the fresh water from the rivers. With the threatening climate change, and the growing impact of human infrastructures, estuarine circulation and its water properties are likely to be affected. In particular, climate projections show that seasonality and magnitude of river discharge are expected to be altered. For fjords and sea lochs, which are usually deep estuaries possessing one or more sills, circulation have density driven dynamic coming from high freshwater input. Consequently, in estuaries with fjord-like geometry, changes in river discharge can deeply transform the stratification profile and the exchange between salty water and fresh water. In return, this can potentially drive more exposure to contaminants and pollutants, benefit to harmful algae blooms or impact aquaculture. Therefore, understanding the impact of changing environmental processes on fjords and sea lochs circulation can provide useful tools to prevent or adapt to their consequences.
This motivated the creation of Feta2D, a fast and flexible circulation model for long time-scale analysis that is developed at the University of Strathclyde. Feta2d is a model adapted to fjord and sea-loch circulation that is based on the solver technics of Eta2d (MacCready 2007), a coastal plain estuaries model. It uses an intermediate approach between the simple box model which runs fast but provide poor details, and the complex 3D models like FVCOM, which has high resolution, but is computationally expensive. The model uses a 2D cartesian grid (vertical and along-channel dimension) with Reynolds Averaged Navier-Stokes (RANS) equations, that are averaged over the tidal cycle and the channel width to improve speed efficiency. Finally, this implementation provides an efficient modelling tool that is easy to adapt to a variety of scenarios. A first application to the Puget Sound (a fjord located on the Pacific coast of USA) is on-going, and it will help discern the possible long-term changes in estuarine circulation driven by regional environmental changes. Feta2D is planned to become an open-source code in 2020, and can easily be applied to a large family of estuary with fjord-like geometry, including Scottish sea lochs.

Example of salinity profile output from Feta2d model using a transect of the Puget Sound and the Strait of Juan de Fuca 

MacCready, P. (2007). Estuarine Adjustment. J. Phy. Oceanogr., 37, 2133-2145.

## Response to projected climate
## Biological population connectivity
In many circumstances it can be useful to understand the connections between spatially separated biological populations. This information can help to identify key areas of habitat, the impact of addition or removal of habitat (Adams et al. 2014) and changes in flow regime (Millar et al. in prep.), patterns of population dynamics (Adams et al. 2015, Rabe et al., ECSS, submitted), and approaches to management of pest species (aquaculture parasites, for example; Salama et al. 2017). 

To derive estimates of connectivity, outputs from hydrodynamic models are used to drive a particle tracking model with a defined timeframe, spatial domain and configuration of habitat sites. An example, derived from salmon farm location on the west coast of Scotland, is given in ***FIGURE***. Particles with a defined set of characteristics (in this case, a time period for development of ability to settle, a mortality rate, a maximum lifespan, and a vertical position) are released from the defined habitat sites. Particles may be released in a single event, or continuously over time, in order to account for tidal effects and/or variability in meteorological conditions. Their locations are recorded over time at defined intervals, allowing the generation of density surfaces ***FIGURE connectivity A***. Any particles moving close to a habitat site after they have become able to settle are considered to make a connection between the origin/source site and the site it has passed close to. This can be summarised in a connectivity matrix ***FIGURE connectivity B ***. Connectivity matrices can be analysed in isolation in order to understand network structure (and the role of habitat sites in the overall population), or they can be applied to describe the redistribution of organisms by dispersal in population models.

Figure connectivity A: spread of infective copepodid sea lice particles from salmon aquaculture sites on the west coast of Scotland 

Figure connectivity B: Connectivity between salmon aquaculture sites on the west coast of Scotland.

## Sharing of resources between tidal developments
